# Отрисовка PDF и рекомендательная система

## Описание проекта

Данный проект — это серверная часть онлайн-платформы для управления и поиска любительских спортивных соревнований. Сервер реализован на Python с использованием gRPC и взаимодействует с Java API (бэкенд) и Redis (кэширование). Основные микросервисы: сервис генерации PDF-документов и рекомендательная система.

---

## Классы пользователей

- **Участник команды (Team member):**
  Может просматривать расписание, результаты матчей, получать рекомендации по чемпионатам.
- **Капитан/Тренер (Team captain/Trainer):**
  Управляет составом команды, подаёт заявки на участие.
- **Организатор чемпионата (Competition manager):**
  Управляет проведением турнира, формирует расписание.
- **Старший организатор (Chief competition manager):**
  Добавляет/исключает организаторов, публикует расписание.
- **Судья (Referee):**
  Фиксирует результаты матчей.

---

## Архитектура и сервисы

- **PDF-сервис:**
  Генерирует PDF-документы с результатами матчей и турниров по запросу через gRPC. Поддерживает разные виды спорта, формирует красивые отчёты с таблицами и статистикой.

- **Рекомендательный сервис:**
  Формирует персональные рекомендации турниров для пользователей на основе их профиля, истории участия и предпочтений. Кэширует результаты в Redis для ускорения повторных запросов.

- **Redis:**
  Используется для кэширования рекомендаций и статусов генерации PDF. Позволяет ускорить работу системы и снизить нагрузку на вычисления.


---

## gRPC API (основные методы)

- **PDFService**
  - `CreateMatchPDF` — генерация PDF для матча
  - `CreateTournamentPDF` — генерация PDF для турнира
  - `GetPDFStatus` — получение статуса генерации PDF

- **RecommenderService**
  - `GetRecommendations` — получить рекомендации для пользователя
  - `UpdateUserData` — обновить профиль пользователя

---

## Развёртывание и запуск

### Быстрый старт в Docker

1. Соберите и запустите все сервисы:
   docker-compose up --build -d

2. Проверьте логи gRPC-сервера:
   docker-compose logs -f grpc-server

3. Остановите сервисы:
   docker-compose down


> Все сервисы будут доступны внутри Docker-сети. gRPC-сервер слушает порт 50051, Redis — 6379.

---

## Тестирование

- Для проверки работы кэша Redis используйте скрипт:

  python src/test_clients/redis_viewer.py

- Для ручного тестирования сервисов используйте:
  - `src/test_clients/test_services.py` — тестирует оба gRPC-сервиса
  - `src/test_clients/recommender_client.py` — тестирует рекомендательную систему

---

## Кэширование

- Кэш рекомендаций хранится в Redis по ключу `recommendations:<user_id>`.
- Кэш автоматически обновляется при изменении профиля пользователя или генерации нового PDF.

---

## Логирование

- Логирование настраивается через переменную окружения `LOG_LEVEL`.
- Все основные действия и ошибки пишутся в консоль и логи контейнера.

